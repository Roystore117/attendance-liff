<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>欠勤連絡システム_V02</title>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-3" style="background-color: #f5f5f5; min-height: 100vh;">
    <div class="container-fluid" style="max-width: 600px;">
        <h3 class="text-center mb-4 pt-3">欠勤連絡システム2_V02</h3>
        
        <form id="absenceForm" class="bg-white rounded-3 shadow-sm p-4 mb-4">
            <!-- 名前 -->
            <div class="mb-4">
                <label for="name" class="form-label fw-bold mb-2">名前 <span class="text-danger">*</span></label>
                <input type="text" class="form-control form-control-lg" id="name" name="name" required placeholder="氏名を入力してください">
            </div>

            <!-- 欠勤日付 -->
            <div class="mb-4">
                <label for="absenceDate" class="form-label fw-bold mb-2">欠勤日付 <span class="text-danger">*</span></label>
                <input type="date" class="form-control form-control-lg" id="absenceDate" name="absenceDate" required>
            </div>

            <!-- 復帰日付 -->
            <div class="mb-4">
                <label for="returnDate" class="form-label fw-bold mb-2">復帰日付 <span class="text-danger">*</span></label>
                <input type="date" class="form-control form-control-lg" id="returnDate" name="returnDate" required>
            </div>

            <!-- 欠勤理由 -->
            <div class="mb-4">
                <label for="reason" class="form-label fw-bold mb-2">欠勤理由 <span class="text-danger">*</span></label>
                <select class="form-select form-select-lg" id="reason" name="reason" required>
                    <option value="">選択してください</option>
                    <option value="体調不良">体調不良</option>
                    <option value="私用">私用</option>
                    <option value="忌引">忌引</option>
                    <option value="その他">その他</option>
                </select>
            </div>

            <!-- 有給利用 -->
            <div class="mb-4">
                <label for="paidLeave" class="form-label fw-bold mb-2">有給利用 <span class="text-danger">*</span></label>
                <select class="form-select form-select-lg" id="paidLeave" name="paidLeave" required>
                    <option value="">選択してください</option>
                    <option value="利用する">利用する</option>
                    <option value="利用しない">利用しない</option>
                </select>
            </div>

            <!-- 詳細理由 -->
            <div class="mb-4">
                <label for="details" class="form-label fw-bold mb-2">詳細理由</label>
                <textarea class="form-control" id="details" name="details" rows="5" placeholder="詳細な理由を入力してください（任意）"></textarea>
            </div>
        </form>

        <!-- 申請ボタン -->
        <button type="submit" form="absenceForm" id="submitBtn" class="btn w-100 p-4 fw-bold text-white" style="background-color: #06C755; border: none; font-size: 1.1rem; border-radius: 12px;">
            申請する
        </button>
    </div>

    <script>
        // ▼▼▼ ここに自分のLIFF IDを入れる ▼▼▼
        const MY_LIFF_ID = "2008863832-Z1XJ08ea"; 

        // 初期化
        liff.init({ liffId: MY_LIFF_ID }).then(() => {
            if (!liff.isLoggedIn()) {
                //★デバッグ用コメントアウト
                liff.login();
            }
        });

        // フォーム送信処理
        document.getElementById('absenceForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // フォームデータを取得
            const formData = {
                name: document.getElementById('name').value,
                absenceDate: document.getElementById('absenceDate').value,
                returnDate: document.getElementById('returnDate').value,
                reason: document.getElementById('reason').value,
                paidLeave: document.getElementById('paidLeave').value,
                details: document.getElementById('details').value
            };

            // メッセージを整形
            const messageText = `【欠勤届】\n\n` +
                `名前: ${formData.name}\n` +
                `欠勤日付: ${formData.absenceDate}\n` +
                `復帰日付: ${formData.returnDate}\n` +
                `欠勤理由: ${formData.reason}\n` +
                `有給利用: ${formData.paidLeave}\n` +
                (formData.details ? `詳細理由: ${formData.details}` : '');

            try {
                await liff.sendMessages([{
                    type: 'text',
                    text: messageText
                }]);
                
                alert("送信しました！");
                liff.closeWindow();
            } catch (err) {
                alert("エラー: " + err);
            }
        });
    </script>
</body>
</html>